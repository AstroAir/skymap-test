# 缩放控制

本文档详细介绍 SkyMap Test 的缩放功能和视野控制。

## 缩放基础

### 视野角度（FOV）

视野角度决定您能看到的天空范围：

| FOV | 等效设备 | 可见范围 |
|-----|---------|---------|
| 180° | 鱼眼镜头 | 半球天空 |
| 90° | 广角镜头 | 约1/4天球 |
| 60° | 肉眼视野 | 自然视角 |
| 10° | 双筒望远镜 | 几个星座 |
| 1° | 望远镜 | 月球大小 |
| 0.1° | 高倍望远镜 | 深空天体 |

### 缩放范围

SkyMap Test 支持的缩放范围：

- **最小 FOV**：0.001°（约3.6角秒）
- **最大 FOV**：180°（全天视图）
- **默认 FOV**：60°

## 缩放操作

### 鼠标滚轮

最常用的缩放方式：

- **向前滚动**：放大（减小 FOV）
- **向后滚动**：缩小（增大 FOV）
- **Ctrl + 滚轮**：精细缩放（1/10 步进）
- **Shift + 滚轮**：快速缩放（10x 步进）

### 键盘快捷键

使用键盘控制缩放：

| 快捷键 | 功能 |
|-------|------|
| + / = | 放大 |
| - / _ | 缩小 |
| Ctrl + + | 精细放大 |
| Ctrl + - | 精细缩小 |
| 0 | 重置为默认 FOV |

### 触摸手势

在触摸设备上：

- **双指张开**：放大
- **双指捏合**：缩小
- **双击**：快速放大到选中天体

### 缩放滑块

使用界面上的缩放滑块：

1. 找到右侧或底部的缩放滑块
2. 拖动滑块调整 FOV
3. 点击滑块两端快速切换

## 视野预设

### 内置预设

快速切换到常用视野：

| 快捷键 | 预设名称 | FOV |
|-------|---------|-----|
| F1 | 广角 | 120° |
| F2 | 标准 | 60° |
| F3 | 中等 | 30° |
| F4 | 窄视野 | 10° |
| F5 | 望远镜 | 1° |
| F6 | 高倍 | 0.1° |

### 自定义预设

创建自己的视野预设：

1. 调整到想要的 FOV
2. 右键点击缩放控制区
3. 选择"保存为预设"
4. 输入预设名称和快捷键

### 设备视野预设

根据设备自动计算：

1. 在设备管理中添加望远镜和相机
2. 选择当前使用的设备组合
3. 点击"应用设备视野"
4. 自动设置为真实视野大小

## 视野计算

### 计算公式

真实视野的计算：

```
FOV（角度）= 2 × arctan(传感器尺寸 / (2 × 焦距))
```

### 望远镜 + 目镜

目视观测的视野计算：

```
真实视野 = 目镜表观视野 / 放大倍数
放大倍数 = 望远镜焦距 / 目镜焦距
```

**示例**：
- 望远镜焦距：1000mm
- 目镜焦距：25mm
- 目镜表观视野：52°
- 放大倍数 = 1000/25 = 40x
- 真实视野 = 52°/40 = 1.3°

### 望远镜 + 相机

摄影的视野计算：

**示例**：
- 望远镜焦距：500mm
- 相机传感器：23.5mm × 15.6mm
- 水平 FOV = 2 × arctan(23.5/(2×500)) = 2.69°
- 垂直 FOV = 2 × arctan(15.6/(2×500)) = 1.79°

## 视野框显示

### 启用视野框

在星图上显示设备视野：

1. 打开设备管理器
2. 选择望远镜和相机
3. 点击"显示视野框"
4. 红色矩形框显示在星图上

### 多视野框

同时显示多个视野框：

- 主镜视野（红色）
- 导星镜视野（绿色）
- 寻星镜视野（蓝色）

### 视野框样式

自定义视野框外观：

- **边框颜色**：自定义颜色
- **边框粗细**：1-5 像素
- **填充**：无/半透明
- **标签**：显示设备名称和 FOV

## 缩放动画

### 平滑缩放

启用平滑过渡效果：

1. 打开设置 → 显示
2. 启用"平滑缩放"
3. 调整动画时长（100-500ms）

### 缩放中心

设置缩放的中心点：

- **鼠标位置**：以鼠标指向位置为中心
- **屏幕中心**：始终以屏幕中心缩放
- **选中天体**：以当前选中天体为中心

## 缩放锁定

### 锁定 FOV

固定当前视野大小：

1. 调整到想要的 FOV
2. 点击缩放锁定图标
3. 滚轮操作将被禁用
4. 再次点击解锁

### 缩放范围限制

限制缩放范围：

- **最小 FOV 限制**：防止过度放大
- **最大 FOV 限制**：防止过度缩小
- 在设置中自定义限制值

## 与其他功能联动

### 搜索定位

搜索天体时的缩放行为：

- **自动缩放**：根据天体大小调整 FOV
- **保持当前**：不改变当前 FOV
- **预设缩放**：缩放到指定 FOV

### 双击定位

双击天体时的行为：

1. 居中显示天体
2. 自动缩放到合适大小
3. 可在设置中调整缩放级别

### 时间控制

时间快进时保持视野：

- 视野大小保持不变
- 天体位置随时间更新
- 跟踪模式下自动调整

## 性能考虑

### 高缩放级别

放大到很高倍数时：

- 加载更高分辨率的 HiPS 瓦片
- 可能需要网络连接
- 可能出现加载延迟

### 低缩放级别

缩小到广角视图时：

- 显示大量天体
- 可能影响性能
- 建议降低星等限制

### 优化建议

提高缩放性能：

1. 启用瓦片缓存
2. 预下载常用区域
3. 适当限制星等显示
4. 使用性能模式

## 常见问题

### 无法继续放大

可能的原因：

- 已达到最小 FOV 限制
- 缩放被锁定
- 尝试按 0 重置

### 缩放不平滑

解决方法：

1. 启用平滑缩放
2. 降低动画时长
3. 检查系统性能
4. 更新显卡驱动

### 视野框不显示

检查步骤：

1. 确认已选择设备
2. 检查"显示视野框"是否启用
3. 确认 FOV 在可见范围内

## 相关文档

- [星图概览](index.md)
- [导航控制](navigation.md)
- [设备管理](../equipment/index.md)
